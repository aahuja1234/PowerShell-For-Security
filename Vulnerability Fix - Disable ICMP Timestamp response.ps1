## This script disables ICMP timestamp responses from machines. By accurately determining the target's clock state, an attacker can more effectively attack certain time-based pseudorandom number generators (PRNGs) and the authentication systems that rely on them.
## It is best to Configure your firewall or filtering router to block outgoing ICMP packets of type 13 or 14 and/or code 0. But, if you need to do this on individual machines, the script can help.

## Naming a variable to check if the registry exists
$DisableIcmpTimestamp = (Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters" -Name "DisableIcmpTimestamp" -ErrorAction SilentlyContinue).DisableIcmpTimestamp

#Checking availability of the variable.If the registry does not exist or DWORD is not found, creating
if ($DisableIcmpTimestamp -eq 1) {Write-Output "IPv4 Registry does not exist.. Creating one..."
  New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters" -Name "DisableIcmpTimestamp" -PropertyType DWORD -Value 0 -Force
  }

## Naming a variable to check if the registry exists
$DisableIcmpTimestamp = (Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters" -Name "DisableIcmpTimestamp" -ErrorAction SilentlyContinue).DisableIcmpTimestamp

#Checking availability of the variable.If the registry does not exist or DWORD is not found, creating
if ($DisableIcmpTimestamp -eq 1) {Write-Output "IPv6 Registry does not exist.. Creating one..."
  New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters" -Name "DisableIcmpTimestamp" -PropertyType DWORD -Value 0 -Force
  }
